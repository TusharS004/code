-- Check the table schemas and data
bq show --format=prettyjson project_id:dataset_id.products
bq show --format=prettyjson project_id:dataset_id.category

-- Run the INNER JOIN query to fetch product_name and price
SELECT p.product_name, p.price
FROM `project_id.dataset_id.products` AS p
INNER JOIN `project_id.dataset_id.category` AS c
ON p.category_id = c.category_id
WHERE c.category_id = 1;

-- Save the query as a view
bq query --use_legacy_sql=false "
CREATE VIEW `project_id.dataset_id.Product_View` AS
SELECT p.product_name, p.price
FROM `project_id.dataset_id.products` AS p
INNER JOIN `project_id.dataset_id.category` AS c
ON p.category_id = c.category_id
WHERE c.category_id = 1;"
